---
import { AddDriver } from '../../components/AddDriver'
import DriverCard from '../../components/DriverCard.astro'
import UserAdd from '../../components/icons/UserAdd.astro'
import InputFilter from '../../components/InputFilter.astro'
import Main from '../../components/Main.astro'
import MainTitle from '../../components/MainTitle.astro'
import LayoutAdmin from '../../layouts/LayoutAdmin.astro'
export const prerender = false
/* Check current session */
if (!Astro.cookies.has('__session')) {
  return Astro.redirect('/signin')
}

const sessionCookie = Astro.cookies.get('__session')?.value

if (!sessionCookie) {
  return Astro.redirect('/signin')
}
---

<LayoutAdmin>
  <Main
    class='relative bg-azur-200/20 p-4 md:p-6 flex flex-col gap-4 md:gap-6 pb-16 sm:pb-6'
  >
    <MainTitle title='Lista de conductores' />

    <section class='flex justify-between gap-x-2 items-center'>
      <InputFilter />
      <button
        id='open-modal'
        class='flex items-center gap-x-1 bg-azur-600 text-azur-50/80 border rounded-xl py-2 px-4 hover:bg-azur-800 hover:text-azur-50'
      >
        <UserAdd />
        Agregar
      </button>
    </section>

    <section
      class='grid grid-cols-[repeat(auto-fit,minmax(250px,350px))] gap-6'
    >
      <DriverCard />
      <DriverCard />
    </section>
    <AddDriver client:load />
  </Main>
</LayoutAdmin>
<script>
  const $openModal = document.getElementById('open-modal')
  const $closeModal = document.getElementById('close-modal')
  const $modal = document.getElementById('modal-add-driver')

  $openModal?.addEventListener('click', () => {
    $modal?.classList.remove('hidden')
  })
  $closeModal?.addEventListener('click', () => {
    $modal?.classList.add('hidden')
  })
</script>
